rule php_backdoor_shell : php
{

    meta:
        description = "Detects PHP Backdoor Shell"
        created_by = "PaulK"
        license = "https://creativecommons.org/licenses/by-nc/4.0/"
        date = "2021-05-24"

    strings:
                $string1 = "FilesMan" nocase
                $string2 = "preg_replace("
                $string3 = "5b19fxq30jD8d/wp5C3tQoMx4CQnxYY4cezEebFTvyRp4tx0gQW2Xli6u5i4qb/7PTN6WWlfME57r"
                $string4 = "<?php"

                condition:
        all of ($string*)
}

rule php_backdoor_install : php
{

    meta:
        description = "Detects PHP Backdoor Install"
        created_by = "PaulK"
        license = "https://creativecommons.org/licenses/by-nc/4.0/"
        date = "2021-05-24"


    strings:
                $string1 = "eval(base64_decode(\"ZnVuY3Rpb24gZmlsZV9nZXRfY29udGVudHNfY3VybCgkdXJsKSB7CiAkY2ggPSBjdXJsX2luaXQoKTsKIGN1cmxfc2V0b3B0KCR"

                condition:
        all of ($string*)
}

rule php_backdoor_proxy : php
{

    meta:
        description = "Detects PHP Backdoor Proxy"
        created_by = "PaulK"
        license = "https://creativecommons.org/licenses/by-nc/4.0/"
        date = "2021-05-24"


    strings:
                $string1 = "transfer.activelyblogging.com/httpsproxy/index.php" nocase
                $string3 = "<?php"

                condition:
        all of ($string*)
}