import "elf"
import "math"
import "pe"



rule mirai_xor_busybox :  detect
{
    meta:
        description = "Detects xored strings in ELF /bin/busybox"
        created_by = "PaulK"
        license = "https://creativecommons.org/licenses/by-nc/4.0/"
        date = "2021-05-24"
		
		
    strings:
        $xor_string = "/bin/busybox" xor

    condition:
		$xor_string
}




rule mirai_xor_busybox_all_keys : detect
{

    meta:
        description = "Detects xored strings in ELF /bin/busybox"
        created_by = "PaulK"
        license = "https://creativecommons.org/licenses/by-nc/4.0/"
        date = "2021-05-24"
		
		
	strings:
		$mirai_xor_0x1 = {2e63686f2e63747278636e79}
		$mirai_xor_0x2 = {2d606b6c2d6077717b606d7a}
		$mirai_xor_0x3 = {2c616a6d2c6176707a616c7b}
		$mirai_xor_0x4 = {2b666d6a2b6671777d666b7c}
		$mirai_xor_0x5 = {2a676c6b2a6770767c676a7d}
		$mirai_xor_0x6 = {29646f68296473757f64697e}
		$mirai_xor_0x7 = {28656e69286572747e65687f}
		$mirai_xor_0x8 = {276a6166276a7d7b716a6770}
		$mirai_xor_0x9 = {266b6067266b7c7a706b6671}
		$mirai_xor_0xa = {2568636425687f7973686572}
		$mirai_xor_0xb = {2469626524697e7872696473}
		$mirai_xor_0xc = {236e6562236e797f756e6374}
		$mirai_xor_0xd = {226f6463226f787e746f6275}
		$mirai_xor_0xe = {216c6760216c7b7d776c6176}
		$mirai_xor_0xf = {206d6661206d7a7c766d6077}
		$mirai_xor_0x10 = {3f72797e3f72656369727f68}
		$mirai_xor_0x11 = {3e73787f3e73646268737e69}
		$mirai_xor_0x12 = {3d707b7c3d7067616b707d6a}
		$mirai_xor_0x13 = {3c717a7d3c7166606a717c6b}
		$mirai_xor_0x14 = {3b767d7a3b7661676d767b6c}
		$mirai_xor_0x15 = {3a777c7b3a7760666c777a6d}
		$mirai_xor_0x16 = {39747f78397463656f74796e}
		$mirai_xor_0x17 = {38757e79387562646e75786f}
		$mirai_xor_0x18 = {377a7176377a6d6b617a7760}
		$mirai_xor_0x19 = {367b7077367b6c6a607b7661}
		$mirai_xor_0x1a = {3578737435786f6963787562}
		$mirai_xor_0x1b = {3479727534796e6862797463}
		$mirai_xor_0x1c = {337e7572337e696f657e7364}
		$mirai_xor_0x1d = {327f7473327f686e647f7265}
		$mirai_xor_0x1e = {317c7770317c6b6d677c7166}
		$mirai_xor_0x1f = {307d7671307d6a6c667d7067}
		$mirai_xor_0x20 = {0f42494e0f42555359424f58}
		$mirai_xor_0x21 = {0e43484f0e43545258434e59}
		$mirai_xor_0x22 = {0d404b4c0d4057515b404d5a}
		$mirai_xor_0x23 = {0c414a4d0c4156505a414c5b}
		$mirai_xor_0x24 = {0b464d4a0b4651575d464b5c}
		$mirai_xor_0x25 = {0a474c4b0a4750565c474a5d}
		$mirai_xor_0x26 = {09444f48094453555f44495e}
		$mirai_xor_0x27 = {08454e49084552545e45485f}
		$mirai_xor_0x28 = {074a4146074a5d5b514a4750}
		$mirai_xor_0x29 = {064b4047064b5c5a504b4651}
		$mirai_xor_0x2a = {0548434405485f5953484552}
		$mirai_xor_0x2b = {0449424504495e5852494453}
		$mirai_xor_0x2c = {034e4542034e595f554e4354}
		$mirai_xor_0x2d = {024f4443024f585e544f4255}
		$mirai_xor_0x2e = {014c4740014c5b5d574c4156}
		$mirai_xor_0x2f = {004d4641004d5a5c564d4057}
		$mirai_xor_0x30 = {1f52595e1f52454349525f48}
		$mirai_xor_0x31 = {1e53585f1e53444248535e49}
		$mirai_xor_0x32 = {1d505b5c1d5047414b505d4a}
		$mirai_xor_0x33 = {1c515a5d1c5146404a515c4b}
		$mirai_xor_0x34 = {1b565d5a1b5641474d565b4c}
		$mirai_xor_0x35 = {1a575c5b1a5740464c575a4d}
		$mirai_xor_0x36 = {19545f58195443454f54594e}
		$mirai_xor_0x37 = {18555e59185542444e55584f}
		$mirai_xor_0x38 = {175a5156175a4d4b415a5740}
		$mirai_xor_0x39 = {165b5057165b4c4a405b5641}
		$mirai_xor_0x3a = {1558535415584f4943585542}
		$mirai_xor_0x3b = {1459525514594e4842595443}
		$mirai_xor_0x3c = {135e5552135e494f455e5344}
		$mirai_xor_0x3d = {125f5453125f484e445f5245}
		$mirai_xor_0x3e = {115c5750115c4b4d475c5146}
		$mirai_xor_0x3f = {105d5651105d4a4c465d5047}
		$mirai_xor_0x40 = {6f22292e6f22353339222f38}
		$mirai_xor_0x41 = {6e23282f6e23343238232e39}
		$mirai_xor_0x42 = {6d202b2c6d2037313b202d3a}
		$mirai_xor_0x43 = {6c212a2d6c2136303a212c3b}
		$mirai_xor_0x44 = {6b262d2a6b2631373d262b3c}
		$mirai_xor_0x45 = {6a272c2b6a2730363c272a3d}
		$mirai_xor_0x46 = {69242f28692433353f24293e}
		$mirai_xor_0x47 = {68252e29682532343e25283f}
		$mirai_xor_0x48 = {672a2126672a3d3b312a2730}
		$mirai_xor_0x49 = {662b2027662b3c3a302b2631}
		$mirai_xor_0x4a = {6528232465283f3933282532}
		$mirai_xor_0x4b = {6429222564293e3832292433}
		$mirai_xor_0x4c = {632e2522632e393f352e2334}
		$mirai_xor_0x4d = {622f2423622f383e342f2235}
		$mirai_xor_0x4e = {612c2720612c3b3d372c2136}
		$mirai_xor_0x4f = {602d2621602d3a3c362d2037}
		$mirai_xor_0x50 = {7f32393e7f32252329323f28}
		$mirai_xor_0x51 = {7e33383f7e33242228333e29}
		$mirai_xor_0x52 = {7d303b3c7d3027212b303d2a}
		$mirai_xor_0x53 = {7c313a3d7c3126202a313c2b}
		$mirai_xor_0x54 = {7b363d3a7b3621272d363b2c}
		$mirai_xor_0x55 = {7a373c3b7a3720262c373a2d}
		$mirai_xor_0x56 = {79343f38793423252f34392e}
		$mirai_xor_0x57 = {78353e39783522242e35382f}
		$mirai_xor_0x58 = {773a3136773a2d2b213a3720}
		$mirai_xor_0x59 = {763b3037763b2c2a203b3621}
		$mirai_xor_0x5a = {7538333475382f2923383522}
		$mirai_xor_0x5b = {7439323574392e2822393423}
		$mirai_xor_0x5c = {733e3532733e292f253e3324}
		$mirai_xor_0x5d = {723f3433723f282e243f3225}
		$mirai_xor_0x5e = {713c3730713c2b2d273c3126}
		$mirai_xor_0x5f = {703d3631703d2a2c263d3027}
		$mirai_xor_0x60 = {4f02090e4f02151319020f18}
		$mirai_xor_0x61 = {4e03080f4e03141218030e19}
		$mirai_xor_0x62 = {4d000b0c4d0017111b000d1a}
		$mirai_xor_0x63 = {4c010a0d4c0116101a010c1b}
		$mirai_xor_0x64 = {4b060d0a4b0611171d060b1c}
		$mirai_xor_0x65 = {4a070c0b4a0710161c070a1d}
		$mirai_xor_0x66 = {49040f08490413151f04091e}
		$mirai_xor_0x67 = {48050e09480512141e05081f}
		$mirai_xor_0x68 = {470a0106470a1d1b110a0710}
		$mirai_xor_0x69 = {460b0007460b1c1a100b0611}
		$mirai_xor_0x6a = {4508030445081f1913080512}
		$mirai_xor_0x6b = {4409020544091e1812090413}
		$mirai_xor_0x6c = {430e0502430e191f150e0314}
		$mirai_xor_0x6d = {420f0403420f181e140f0215}
		$mirai_xor_0x6e = {410c0700410c1b1d170c0116}
		$mirai_xor_0x6f = {400d0601400d1a1c160d0017}
		$mirai_xor_0x70 = {5f12191e5f12050309121f08}
		$mirai_xor_0x71 = {5e13181f5e13040208131e09}
		$mirai_xor_0x72 = {5d101b1c5d1007010b101d0a}
		$mirai_xor_0x73 = {5c111a1d5c1106000a111c0b}
		$mirai_xor_0x74 = {5b161d1a5b1601070d161b0c}
		$mirai_xor_0x75 = {5a171c1b5a1700060c171a0d}
		$mirai_xor_0x76 = {59141f18591403050f14190e}
		$mirai_xor_0x77 = {58151e19581502040e15180f}
		$mirai_xor_0x78 = {571a1116571a0d0b011a1700}
		$mirai_xor_0x79 = {561b1017561b0c0a001b1601}
		$mirai_xor_0x7a = {5518131455180f0903181502}
		$mirai_xor_0x7b = {5419121554190e0802191403}
		$mirai_xor_0x7c = {531e1512531e090f051e1304}
		$mirai_xor_0x7d = {521f1413521f080e041f1205}
		$mirai_xor_0x7e = {511c1710511c0b0d071c1106}
		$mirai_xor_0x7f = {501d1611501d0a0c061d1007}
		$mirai_xor_0x80 = {afe2e9eeafe2f5f3f9e2eff8}
		$mirai_xor_0x81 = {aee3e8efaee3f4f2f8e3eef9}
		$mirai_xor_0x82 = {ade0ebecade0f7f1fbe0edfa}
		$mirai_xor_0x83 = {ace1eaedace1f6f0fae1ecfb}
		$mirai_xor_0x84 = {abe6edeaabe6f1f7fde6ebfc}
		$mirai_xor_0x85 = {aae7ecebaae7f0f6fce7eafd}
		$mirai_xor_0x86 = {a9e4efe8a9e4f3f5ffe4e9fe}
		$mirai_xor_0x87 = {a8e5eee9a8e5f2f4fee5e8ff}
		$mirai_xor_0x88 = {a7eae1e6a7eafdfbf1eae7f0}
		$mirai_xor_0x89 = {a6ebe0e7a6ebfcfaf0ebe6f1}
		$mirai_xor_0x8a = {a5e8e3e4a5e8fff9f3e8e5f2}
		$mirai_xor_0x8b = {a4e9e2e5a4e9fef8f2e9e4f3}
		$mirai_xor_0x8c = {a3eee5e2a3eef9fff5eee3f4}
		$mirai_xor_0x8d = {a2efe4e3a2eff8fef4efe2f5}
		$mirai_xor_0x8e = {a1ece7e0a1ecfbfdf7ece1f6}
		$mirai_xor_0x8f = {a0ede6e1a0edfafcf6ede0f7}
		$mirai_xor_0x90 = {bff2f9febff2e5e3e9f2ffe8}
		$mirai_xor_0x91 = {bef3f8ffbef3e4e2e8f3fee9}
		$mirai_xor_0x92 = {bdf0fbfcbdf0e7e1ebf0fdea}
		$mirai_xor_0x93 = {bcf1fafdbcf1e6e0eaf1fceb}
		$mirai_xor_0x94 = {bbf6fdfabbf6e1e7edf6fbec}
		$mirai_xor_0x95 = {baf7fcfbbaf7e0e6ecf7faed}
		$mirai_xor_0x96 = {b9f4fff8b9f4e3e5eff4f9ee}
		$mirai_xor_0x97 = {b8f5fef9b8f5e2e4eef5f8ef}
		$mirai_xor_0x98 = {b7faf1f6b7faedebe1faf7e0}
		$mirai_xor_0x99 = {b6fbf0f7b6fbeceae0fbf6e1}
		$mirai_xor_0x9a = {b5f8f3f4b5f8efe9e3f8f5e2}
		$mirai_xor_0x9b = {b4f9f2f5b4f9eee8e2f9f4e3}
		$mirai_xor_0x9c = {b3fef5f2b3fee9efe5fef3e4}
		$mirai_xor_0x9d = {b2fff4f3b2ffe8eee4fff2e5}
		$mirai_xor_0x9e = {b1fcf7f0b1fcebede7fcf1e6}
		$mirai_xor_0x9f = {b0fdf6f1b0fdeaece6fdf0e7}
		$mirai_xor_0xa0 = {8fc2c9ce8fc2d5d3d9c2cfd8}
		$mirai_xor_0xa1 = {8ec3c8cf8ec3d4d2d8c3ced9}
		$mirai_xor_0xa2 = {8dc0cbcc8dc0d7d1dbc0cdda}
		$mirai_xor_0xa3 = {8cc1cacd8cc1d6d0dac1ccdb}
		$mirai_xor_0xa4 = {8bc6cdca8bc6d1d7ddc6cbdc}
		$mirai_xor_0xa5 = {8ac7cccb8ac7d0d6dcc7cadd}
		$mirai_xor_0xa6 = {89c4cfc889c4d3d5dfc4c9de}
		$mirai_xor_0xa7 = {88c5cec988c5d2d4dec5c8df}
		$mirai_xor_0xa8 = {87cac1c687cadddbd1cac7d0}
		$mirai_xor_0xa9 = {86cbc0c786cbdcdad0cbc6d1}
		$mirai_xor_0xaa = {85c8c3c485c8dfd9d3c8c5d2}
		$mirai_xor_0xab = {84c9c2c584c9ded8d2c9c4d3}
		$mirai_xor_0xac = {83cec5c283ced9dfd5cec3d4}
		$mirai_xor_0xad = {82cfc4c382cfd8ded4cfc2d5}
		$mirai_xor_0xae = {81ccc7c081ccdbddd7ccc1d6}
		$mirai_xor_0xaf = {80cdc6c180cddadcd6cdc0d7}
		$mirai_xor_0xb0 = {9fd2d9de9fd2c5c3c9d2dfc8}
		$mirai_xor_0xb1 = {9ed3d8df9ed3c4c2c8d3dec9}
		$mirai_xor_0xb2 = {9dd0dbdc9dd0c7c1cbd0ddca}
		$mirai_xor_0xb3 = {9cd1dadd9cd1c6c0cad1dccb}
		$mirai_xor_0xb4 = {9bd6ddda9bd6c1c7cdd6dbcc}
		$mirai_xor_0xb5 = {9ad7dcdb9ad7c0c6ccd7dacd}
		$mirai_xor_0xb6 = {99d4dfd899d4c3c5cfd4d9ce}
		$mirai_xor_0xb7 = {98d5ded998d5c2c4ced5d8cf}
		$mirai_xor_0xb8 = {97dad1d697dacdcbc1dad7c0}
		$mirai_xor_0xb9 = {96dbd0d796dbcccac0dbd6c1}
		$mirai_xor_0xba = {95d8d3d495d8cfc9c3d8d5c2}
		$mirai_xor_0xbb = {94d9d2d594d9cec8c2d9d4c3}
		$mirai_xor_0xbc = {93ded5d293dec9cfc5ded3c4}
		$mirai_xor_0xbd = {92dfd4d392dfc8cec4dfd2c5}
		$mirai_xor_0xbe = {91dcd7d091dccbcdc7dcd1c6}
		$mirai_xor_0xbf = {90ddd6d190ddcaccc6ddd0c7}
		$mirai_xor_0xc0 = {efa2a9aeefa2b5b3b9a2afb8}
		$mirai_xor_0xc1 = {eea3a8afeea3b4b2b8a3aeb9}
		$mirai_xor_0xc2 = {eda0abaceda0b7b1bba0adba}
		$mirai_xor_0xc3 = {eca1aaadeca1b6b0baa1acbb}
		$mirai_xor_0xc4 = {eba6adaaeba6b1b7bda6abbc}
		$mirai_xor_0xc5 = {eaa7acabeaa7b0b6bca7aabd}
		$mirai_xor_0xc6 = {e9a4afa8e9a4b3b5bfa4a9be}
		$mirai_xor_0xc7 = {e8a5aea9e8a5b2b4bea5a8bf}
		$mirai_xor_0xc8 = {e7aaa1a6e7aabdbbb1aaa7b0}
		$mirai_xor_0xc9 = {e6aba0a7e6abbcbab0aba6b1}
		$mirai_xor_0xca = {e5a8a3a4e5a8bfb9b3a8a5b2}
		$mirai_xor_0xcb = {e4a9a2a5e4a9beb8b2a9a4b3}
		$mirai_xor_0xcc = {e3aea5a2e3aeb9bfb5aea3b4}
		$mirai_xor_0xcd = {e2afa4a3e2afb8beb4afa2b5}
		$mirai_xor_0xce = {e1aca7a0e1acbbbdb7aca1b6}
		$mirai_xor_0xcf = {e0ada6a1e0adbabcb6ada0b7}
		$mirai_xor_0xd0 = {ffb2b9beffb2a5a3a9b2bfa8}
		$mirai_xor_0xd1 = {feb3b8bffeb3a4a2a8b3bea9}
		$mirai_xor_0xd2 = {fdb0bbbcfdb0a7a1abb0bdaa}
		$mirai_xor_0xd3 = {fcb1babdfcb1a6a0aab1bcab}
		$mirai_xor_0xd4 = {fbb6bdbafbb6a1a7adb6bbac}
		$mirai_xor_0xd5 = {fab7bcbbfab7a0a6acb7baad}
		$mirai_xor_0xd6 = {f9b4bfb8f9b4a3a5afb4b9ae}
		$mirai_xor_0xd7 = {f8b5beb9f8b5a2a4aeb5b8af}
		$mirai_xor_0xd8 = {f7bab1b6f7baadaba1bab7a0}
		$mirai_xor_0xd9 = {f6bbb0b7f6bbacaaa0bbb6a1}
		$mirai_xor_0xda = {f5b8b3b4f5b8afa9a3b8b5a2}
		$mirai_xor_0xdb = {f4b9b2b5f4b9aea8a2b9b4a3}
		$mirai_xor_0xdc = {f3beb5b2f3bea9afa5beb3a4}
		$mirai_xor_0xdd = {f2bfb4b3f2bfa8aea4bfb2a5}
		$mirai_xor_0xde = {f1bcb7b0f1bcabada7bcb1a6}
		$mirai_xor_0xdf = {f0bdb6b1f0bdaaaca6bdb0a7}
		$mirai_xor_0xe0 = {cf82898ecf82959399828f98}
		$mirai_xor_0xe1 = {ce83888fce83949298838e99}
		$mirai_xor_0xe2 = {cd808b8ccd8097919b808d9a}
		$mirai_xor_0xe3 = {cc818a8dcc8196909a818c9b}
		$mirai_xor_0xe4 = {cb868d8acb8691979d868b9c}
		$mirai_xor_0xe5 = {ca878c8bca8790969c878a9d}
		$mirai_xor_0xe6 = {c9848f88c98493959f84899e}
		$mirai_xor_0xe7 = {c8858e89c88592949e85889f}
		$mirai_xor_0xe8 = {c78a8186c78a9d9b918a8790}
		$mirai_xor_0xe9 = {c68b8087c68b9c9a908b8691}
		$mirai_xor_0xea = {c5888384c5889f9993888592}
		$mirai_xor_0xeb = {c4898285c4899e9892898493}
		$mirai_xor_0xec = {c38e8582c38e999f958e8394}
		$mirai_xor_0xed = {c28f8483c28f989e948f8295}
		$mirai_xor_0xee = {c18c8780c18c9b9d978c8196}
		$mirai_xor_0xef = {c08d8681c08d9a9c968d8097}
		$mirai_xor_0xf0 = {df92999edf92858389929f88}
		$mirai_xor_0xf1 = {de93989fde93848288939e89}
		$mirai_xor_0xf2 = {dd909b9cdd9087818b909d8a}
		$mirai_xor_0xf3 = {dc919a9ddc9186808a919c8b}
		$mirai_xor_0xf4 = {db969d9adb9681878d969b8c}
		$mirai_xor_0xf5 = {da979c9bda9780868c979a8d}
		$mirai_xor_0xf6 = {d9949f98d99483858f94998e}
		$mirai_xor_0xf7 = {d8959e99d89582848e95988f}
		$mirai_xor_0xf8 = {d79a9196d79a8d8b819a9780}
		$mirai_xor_0xf9 = {d69b9097d69b8c8a809b9681}
		$mirai_xor_0xfa = {d5989394d5988f8983989582}
		$mirai_xor_0xfb = {d4999295d4998e8882999483}
		$mirai_xor_0xfc = {d39e9592d39e898f859e9384}
		$mirai_xor_0xfd = {d29f9493d29f888e849f9285}
		$mirai_xor_0xfe = {d19c9790d19c8b8d879c9186}
		$mirai_xor_0xff = {d09d9691d09d8a8c869d9087}
	condition:
		uint32(0)== 0x464C457F and any of them
}


rule cve_2018_10561 : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Detect Gpon Exploits "
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "/GponForm/diag_Form?images/"
		$str2 = "XWebPageName=diag&diag_action=ping"
		

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}



rule cve_2018_17173 : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Detect LG Supersign TV Exploit "
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "/qsrserver/device/getThumbnail?"
		$str2 = "supersign_p"
		$str3 = "/bin/sh"
		

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule exploit_wepresent_wipg : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "WePresent WiPG-1000 - Command Injection"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "POST /cgi-bin/rdfs.cgi"
		$str2 = "wepresent_p"
		$str3 = "Download=submit"
		

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule exploit_dlink_dcs930l_rce : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "DLink DCS-930L Remote Command Execution"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "POST /setSystemCommand"
		$str2 = "ReplySuccessPage="
		$str3 = "SystemCommand="
		$str4 = "ConfigSystemCommand=Save"
		

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}


rule exploit_dlink_diagnostic : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "DLink diagnostic.php Command Execution"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "POST /diagnostic.php"
		$str2 = "act=ping&dst=&"
		$str3 = "dlinkdir_p"	

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}


rule exploit_zyxel_p660_rce : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Zyxel P660HN Remote Command Execution"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $strv1_1 = "POST /cgi-bin/pages/maintenance/logSetting/logSet.asp"
		$strv1_2 = "logSetting_H=1&active=1&logMode=LocalAndRemote&server"
		$strv2_1 = "POST /cgi-bin/ViewLog.asp"
		$strv2_2 = "remote_submit_Flag=1&remote_syslog_Flag=1&RemoteSyslogSupported=1&LogFlag=0&remote_host="

    condition:
		uint32(0)== 0x464C457F and (all of ($strv1*) or all of ($strv2*))
}


rule exploit_cve_2014_8361 : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Exploit on Different devices using the Realtek SDK with the miniigd daemon"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "POST /picsdesc.xml"
		$str2 = "<NewRemoteHost>"
		$str3 = "<NewPortMappingDescription"	
		$str4 = "AddPortMapping"

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule exploit_netgear_dgn1000 : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Exploit on DGN1000 Netgear routers"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "GET /setup.cgi?next_file=netgear.cfg&todo=syscmd&cmd="

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule exploit_cve_2017_17215 : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Exploit on Huawei HG532"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "POST /ctrlt/DeviceUpgrade_1"
		$str2 = "<NewStatusURL>"

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule exploit_eir_wan_side : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Remote Command Injection on Eir D1000 routers"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "POST /UD/"
		$str2 = "<NewNTPServer"
		$str3 = "SetNTPServers xmlns"
		$str4 = "SOAP-ENV:encodingStyle"

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule exploit_hnap_soap_action : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "HNAP SoapAction-Header Command Execution"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "POST /HNAP1/"
		$str2 = "SOAPAction: http://purenetworks.com/HNAP1/"

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}


rule exploit_cctv_dvr_rce : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "CCTV-DVR Remote Code Execution"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "GET /language/Swedish${IFS}&&"

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule exploit_jaws_webserver : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "CCTV/DVR Remote Code Execution"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "GET /shell?"
		$str2 = "jaws"
		$str3 = "sh"

    condition:
		uint32(0)== 0x464C457F and all of ($str*) and (@str1 + 200 < @str2)
}

rule exploit_upnp_soap_action : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "UPnP SOAP TelnetD Command Execution"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"
		
		
    strings:
        $req_1 = "POST /soap.cgi?service=WANIPConn1"
		$req_21 = "POST /wanipcn.xml"
		$req_22 = "upnp-org:service:WANIPConnection"
		$str2 = "AddPortMapping"
		$str3 = "<NewInternalClient>"
		$str4 = "NewRemoteHost"

    condition:
		uint32(0)== 0x464C457F and all of ($str*) and ($req_1 or ($req_21 and $req_22))
}


rule exploit_netgear_cgi_bin : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Netgear cgi-bin Command Injection"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "GET /cgi-bin/"
		$str2 = "${IFS}"
	

    condition:
		uint32(0)== 0x464C457F and $str1 and #str2 > 2
}


rule exploit_vacron_rce : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Vacron NVR RCE"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str1 = "GET /board.cgi?cmd="
		$str2 = "vacron"
		
		$post1 = "POST /board.cgi"
		$post2 = "cmd="
		$post3 = "vac.sh"
	

    condition:
		uint32(0)== 0x464C457F and (all of ($str*) or all of ($post*))
}

rule exploit_linksys : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Linksys RCE"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
        $str_block1 = "POST /tmBlock.cgi"
		$str_block2 = "POST /tmUnblock.cgi"
		$str_block3 = "POST /hndBlock.cgi"
		$str_block4 = "POST /hndUnblock.cgi"
		$str_req1 = "submit_button="
		$str_req2 = "change_action="
		$str_req3 = "ttcp_num="
	

    condition:
		uint32(0)== 0x464C457F and all of ($str_req*) and any of ($str_block*)
}



 
rule exploit_avtech : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "AVTECH  Unauthenticated Command Injection"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
        $str1 = "GET /cgi-bin/nobody/Search.cgi?action=cgi_query"
		$str2 = "username="
		$str3 = "password="
	

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}



rule exploit_cve_2017_6884 : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "CVE-2017-6884"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
        $str1 = "GET /cgi-bin/luci/"
		$str2 = "<Clipped>"
		$str3 = "expert/maintenance/diagnostic/nslookup"
	

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}


rule exploit_netgain_command_injection : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "NetGain ping Command Injection"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
        $str1 = "POST /u/jsp/tools/exec.jsp"
		$str2 = "command=cmd"
	

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}


rule exploit_nuuo_nvr : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Vacron NVR RCE"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
        $exp1_1 = "POST /handle_iscsi.php"
		$exp1_2 = "loginName=admin"
		$exp1_3 = "act=discover"
		
		$exp2_1 = "POST /cgi-bin/cgi_system?cmd=saveconfig"
		$exp2_2 = "bfile="
		
		
	

    condition:
		uint32(0)== 0x464C457F and (all of ($exp1*) or all of ($exp2*))
}

rule exploit_engenious_rce : detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "EnGenius RCE"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
        $str1 = "POST /web/cgi-bin/usbinteract.cgi"
		$str2 = "action=7"
	

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule exploit_cve_2016_1555: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "CVE-2016-1555"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
        $str1 = /GET \/boardData.*writeData=.*macAddress=.*netgear/
	

    condition:
		uint32(0)== 0x464C457F and $str1
}

rule exploit_netgear_prosafe: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Netgear Prosafe Remote Command Execution"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
        $str1 = "POST /login_handler.php"
		$str2 = "reqMethod=json_cli_reqMethod"
	

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule exploit_netgear_readynas: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Netgear ReadyNAS Remote Command Execution CVE-2018-15716"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
        $str1 = "GET /upgrade_handle.php?cmd=writeuploaddir&uploaddir"
		$str2 = "readynas"
	

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule exploit_zte_rce: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "ZTE Remote Command Execution"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
        $str1 = "GET /getpage.gch?pid=1002&nextpage=manager_dev_ping_t.gch"
	

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule exploit_brute_force_auth: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Brute-force with base64 admin"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
        $str1 = "Authorization: Basic YWRtaW46YWRtaW4"
	

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule exploit_linksys_apply_cgi_rce: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Linksys apply.cgi Remote Command Execution"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
        $str1 = "Authorization: Basic YWRtaW46YWRtaW4"
		$str2 = "POST /apply.cgi"
		$str3 = "submit_button=Diagnostics"
	

    condition:
		uint32(0)== 0x464C457F and all of ($str*)
}

rule gafgyt: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Gafgyt not-stripped binaries"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
        $tcp1 = "syn" nocase
		$tcp2 = "rst" nocase
		$tcp3 = "fin" nocase
		$tcp4 = "ack" nocase
		$tcp5 = "psh" nocase
		
		
		$str1 = "sendTCP"
		$str2 = "SendHTTP"
		$str3 = "HackerScan"
		$str4 = "getOurIP"
		$str5 = "sendUDP"
		$str6 = "infect"
		$str7 = "botkiller"
		$str8 = "/dropbear"
		$str9 = "RandomIP"
		$str10 = "service iptables stop"
		$str11 = "service firewalld stop"
		$str12 = "8.8.8.8"
		$str13 = "searchdomain"
		$str14 = "open_nameserver"
		$str15 = "makeRandomStr"
		$str16 = "XMAS"
		$str17 = "RUDP"
		$str18 = "sendJUNK"
		$str19 = "findRandIP"
		$str20 = {1b 5b (30 | 31) 3b}
		$str21 = "HTTPHEX"
		$str22 = "HTTP Flood"
		$str23 = "fucking netis" nocase
		$str24 = "/bins.sh"
	

    condition:
		uint32(0)== 0x464C457F and 6 of ($str*) and 3 of ($tcp*)
}

rule gafgyt_stripped: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Gafgyt stripped binaries"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
		$tcp1 = "syn" nocase
		$tcp2 = "rst" nocase
		$tcp3 = "fin" nocase
		$tcp4 = "ack" nocase
		$tcp5 = "psh" nocase
		
		$wierd = {1b 5b (30 | 31) 3b}
		
		$str1 = "service firewalld stop"
		$str2 = "service iptables stop"
		$str3 = "/bins.sh"
		$str4 = "(wget )| (curl )"
		$str5 = "KILLATTK"
		$str6 = "FUCKOFF"
		$str7 = "qbotbotnet"
		$str8 = "/dev/FTWDT101_watchdog"
		$str9 = {49 4e 46 45 43 54 45 44 1b}
		
	
    condition:
		uint32(0)== 0x464C457F and 3 of ($str*) and 3 of ($tcp*) and #wierd > 2	
	
}


rule iot_pnscan: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Linux Tsunami malware"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
		
		$str1 = "__get_myaddress"
		$str2 = "Scanning with cidr:"
		$str3 = "pnscan"
		$str4 = "*** GOT EOF ***"

	
    condition:
		uint32(0)== 0x464C457F and 2 of ($str*)
	
}

rule bossabot: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Bossabot malware"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
		
		$str1 = "POST %s?%%2D%%64+%%61%%6C%%6C%%6F%%77"
		$str2 = "/cgi-bin/"

	
    condition:
		uint32(0)== 0x464C457F and $str1 and #str2 > 10
	
}

rule dirtycow: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "DirtyCow root privilege escalation"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
		
		$str1 = "DirtyCow"
		$str2 = "root privilege escalation"
		$str3 = "/usr/bin/passwd"

	
    condition:
		uint32(0)== 0x464C457F and $str3 and ($str1 or $str2)
	
}

rule go_stealthworker: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Stealthworker Malware"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
		
		$str1 = "StealthWorker/Worker"
		$str2 = "/usr/local/go/"

	
    condition:
		uint32(0)== 0x464C457F and all of ($str*)
	
}


rule go_backdoor: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "go backdoor miner - ddgs"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
		
		$str1 = "xlist.go"
		$str2 = "backdoor.go"
		$str3 = "miner.go"
		
		$go_bin = "/usr/lib/go/"

	
    condition:
		uint32(0)== 0x464C457F and all of ($str*) and #go_bin > 10
	
}



rule ns_ploit: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "ns_ploit"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"
		

		
		
    strings:
		
		$str1 = "/bin/sh"
		
		$ns_ploit = "/ns_sploit/"

	
    condition:
		uint32(0)== 0x464C457F and $str1 and #ns_ploit > 2
	
}



rule sotdas: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "sotdas"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
		
		$str1 = "xargs kill -9"
		$str2 = " stop "
		$str3 = "iptables"
		$str4 = "chmod 777"
		$str5 = "SYN@"
		$str6 = "TCP@"
		

	
    condition:
		uint32(0)== 0x464C457F and all of ($str*)
	
}


rule vpnfilter: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "vpnfilter"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.5"

		
		
    strings:
		
		$str1 = "/flash/nova/etc/loader"
		$str2 = "/flash/nova/etc/init"
		$uni5 = "/proc/%s/"
		$uni6 = "GET %s?me=%s"

		

	
    condition:
		uint32(0)== 0x464C457F and all of ($str*) and ($uni5 or $uni6)
	
}

rule mod_upx : packer
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Generic detection for modified UPX stub"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.25"
		
	//strings:
	//	$mod_upx = {0a 00 00 00}		
		
	condition:
		uint32(uint16(0x2A)*uint16(0x2c) + uint32(0x1c) + 4) == uint32(filesize - 0x24) and 
		uint32(uint16(0x2A)*uint16(0x2c) + uint32(0x1c) + 4) !=  0x21585055 and //UPX!
		uint32(uint16(0x2A)*uint16(0x2c) + uint32(0x1c) + 4) != 0x00000000 and 
		uint32(uint16(0x2A)*uint16(0x2c) + uint32(0x1c) + 4) != 0x214c534b and //KSL! Koolshare files fro China
		math.entropy(300, 1000) >= 7 and
		(elf.number_of_sections == 0 or elf.number_of_sections>1000) and 
		elf.number_of_segments < 4

} 

rule mod_upx_be : packer
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Generic detection for modified UPX stub Big Endian"
		version = "1.0"
		date = "2019-04-08"
		severity ="0.25"
		
	//strings:
	//	$mod_upx = {0a 00 00 00}			
		
	condition:
		uint32(uint16be(0x2A)*uint16be(0x2c) + uint32be(0x1c) + 4) == uint32(filesize - 0x24) and 
		uint32(uint16be(0x2A)*uint16be(0x2c) + uint32be(0x1c) + 4) !=  0x21585055 and //UPX!
		uint32(uint16be(0x2A)*uint16be(0x2c) + uint32be(0x1c) + 4) != 0x00000000 and		
		math.entropy(300, 1000) >= 7 and
		(elf.number_of_sections == 0 or elf.number_of_sections>1000) and elf.number_of_segments < 4

} 



rule pink_backdoor: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "pink backdoor"
		version = "1.0"
		date = "2019-04-08"
		severity = "0.5"
		
		
    strings:
		
		$str1 = "pink78day"
		$str2 = "/tmp/pink/fc_port"
		$hex = "E0D69282C0FF7839CE05E83864C2893DDA7193D0598F04E70F31B6DAAAF893B5FD905C425B7130CA7B18071F5E45B0"


		

	
    condition:
		uint32(0)== 0x464C457F and (all of ($str*) or $hex)
	
}

rule rekoobe: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Rekoobe Backdoor"
		version = "1.0"
		date = "2019-05-14"
		severity = "0.5"
		
    strings:
		
		$syscalls_1 = "shutdown"   
		$syscalls_2 = "ttyname"
		$syscalls_3 = "execl"
		$syscalls_4 = "fork"
		$syscalls_5 = "recv"
		$syscalls_6 = "socket"
		$hex_1 = {000048ba5c5c5c5c5c5c5c5c488910}
		$hex_2 = {000048ba5c5c5c5c5c5c5c5c488993}


		

	
    condition:
		uint32(0)== 0x464C457F and all of ($syscalls*) and any of ($hex_*)
	
}

rule linux_tsunami: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Tsunami Backdoor"
		version = "1.0"
		date = "2019-05-21"
		severity = "0.5"
		
		
    strings:
		
		$string1 = "echo -e '\\x41\\x4b\\x34\\x37'"
		$string2 = "AK-47 SCANNER STARTED!"
		$string3 = "Starting Flood... Nigga"
		$string4 = "PRIVMSG %s :ACK <target> <port> <secs>"
		$string5 = "An advanced syn flooder that will kill"
		$string6 = "XMAS <target> <port>"
		$string7 = "PRIVMSG %s :[STD]Hitting %s"
        $string8 = "NOTICE %s :TSUNAMI <target> <secs>"
		$string9 = "PRIVMSG %s :ACK <target> <port> <secs>"
		$string10 = "Remote IRC Bot"
		$string11 = "NOTICE %s :I'm having a problem resolving my host, someone will have to SPOOFS me manually."

		
    condition:
		uint32(0)== 0x464C457F and any of ($string*)
	
}


rule billgates: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Linux Bill Gates Malware"
		version = "1.0"
		date = "2019-05-22"
		severity = "0.5"
		
		
    strings:
		
		$string1 = "CFakeDetectPayload"
		$string2 = "CLoopCmd"
		$string3 = "CShellCmd"


		
    condition:
		uint32(0)== 0x464C457F and all of ($string*)
	
}

rule ddostf: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "DdosTF Flooder"
		version = "1.0"
		date = "2019-05-22"
		severity = "0.5"
		
		
    strings:
		
		$func1 = "GETFT_Flood"
		$func2 = "TCP_Flood"
		$strings1 = {ae 54 43 50 5f 4b 45 45 50 49 4e 54 56 4c e9 94} //"TCP_KEEPINTVL"
		$strings2 = {ae 54 43 50 5f 4b 45 45 50 43 4e 54 e9 94 99 e8} //"TCP_KEEPCNT"
		$strings3 = "SYN-Flow"
		$strings4 = "chmod 777 %s"
		$strings5 = "UDP-Flow"

		
    condition:
		uint32(0)== 0x464C457F and (all of ($func*)  or 3 of ($strings*))
	
}


rule aesddos: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "AES Ddos Flooder aka Mr.Black aka dofloo"
		version = "1.0"
		date = "2019-05-22"
		severity = "0.5"
		
		
    strings:
		
		$strings1 = "VERSONEX:"
		$strings2 = "Hacker"
	

		
    condition:
		uint32(0)== 0x464C457F and all of ($strings*)
	
}


rule aesddos_2: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "AES Ddos Flooder aka Mr.Black aka dofloo"
		version = "1.0"
		date = "2019-05-22"
		severity = "0.5"
		
		
    strings:
		
		$strings1 = "VERS0NEX:%s"
		$strings3 = "connect to server"

		
    condition:
		uint32(0)== 0x464C457F and all of ($strings*)
	
}


rule xmrig_miner: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "XMRig Miner"
		version = "1.0"
		date = "2019-05-22"
		severity = "0.5"
		
		
    strings:
		
		$gen_strings1 = "cryptonight"
		$gen_strings2 = "miner"
		$gen_strings3 = "pool"
		$specific_strings1 = " xmrig "
		$specific_strings3 = "stratum+tcp://"
		$specific_strings4 = "stratum+ssl://"
		$specific_strings5 = ".minergate.com"
		$specific_strings6 = "xmr.pool."
		
		
		
    condition:
		uint32(0)== 0x464C457F and (any of ($specific_strings*) or all of ($gen_strings*))
	
}

rule linux_helios: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Linux Helios"
		version = "1.0"
		date = "2019-05-22"
		severity = "0.5"
		
		
    strings:
		
		$strings2 = "PEACE OUT IMMA DUP"
		$strings3 = "Attempting To Brute"
	

		
    condition:
		uint32(0)== 0x464C457F and all of ($strings*)
	
}


rule linux_elknot: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Linux Elknot"
		version = "1.0"
		date = "2019-05-22"
		severity = "0.5"
		
		
    strings:
		
		$strings1 = "CThreadHostStatus"
		$strings2 = /\x00\w\w\w\w\.cfg\x00/
		$strings3 = "CThreadAttack"
		$strings4 = "api_log_utility_file_cut_and_move"
		
	

		
    condition:
		uint32(0)== 0x464C457F and all of ($strings*)
	
}


rule fbot: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "fbot previously mirai_gen7"
		reference = "https://blog.malwaremustdie.org/2020/02/mmd-0065-2021-linuxmirai-fbot-re.html"
		version = "1.0"
		date = "2019-05-22"
		severity = "0.5"
		
		
    strings:
		
		$busybox_string = "/bin/busybox"
		$strings1 = "/bin/busybox chmod 777"
		$strings2 = " tftp "
		$strings3 = "wget http://"
	

		
    condition:
		uint32(0)== 0x464C457F and all of ($strings*) and #busybox_string > 5
	
}


rule connectback: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Detects Small Linux Connectback malware"
		version = "1.0"
		date = "2019-05-23"
		severity = "0.5"
		
		
    strings:
		
		$socket_x64 = {6a 29 58 99 6a 02 5f 6a 01 5e 0f 05}
		$socket_x86 = {6a 0a 5e 31 db f7 e3 53 43 53 6a 02 
					   b0 66 89 e1 cd 80 97 5b 68 ?? ?? ?? 
					   ?? 68 02 00 ?? ?? 89 e1 6a 66 58 50 
					   51 57 89 e1 43 cd 80}
					   
		$connect_x64 = {48 97 48 B9 02 00 ?? ?? ?? ?? ?? ?? 51 48 89 e6 6a 10 5a 6a 2a 58 0f 05}

	

		
    condition:
		uint32(0)== 0x464C457F and filesize < 300 and  
		(($socket_x64 in (elf.entry_point..elf.entry_point + 50) and $connect_x64)  or 
		$socket_x86 in (elf.entry_point..elf.entry_point + 50))
	
}


rule mirai_xor_dev_watchdog: detect
{
	meta:
		author = "Paul Kimayong"
		filetype = "elf"
		description = "Mirai Xored Strings"
		version = "1.0"
		date = "2019-05-23"
		severity = "0.5"


	strings:
		$mirai_xor_0x1 = {002e6564772e6c6872622e7660756269656e66}
		$mirai_xor_0x2 = {002d6667742d6f6b71612d756376616a666d65}
		$mirai_xor_0x3 = {002c6766752c6e6a70602c746277606b676c64}
		$mirai_xor_0x4 = {002b6061722b696d77672b736570676c606b63}
		$mirai_xor_0x5 = {002a6160732a686c76662a726471666d616a62}
		$mirai_xor_0x6 = {0029626370296b6f756529716772656e626961}
		$mirai_xor_0x7 = {0028636271286a6e746428706673646f636860}
		$mirai_xor_0x8 = {00276c6d7e2765617b6b277f697c6b606c676f}
		$mirai_xor_0x9 = {00266d6c7f2664607a6a267e687d6a616d666e}
		$mirai_xor_0xa = {00256e6f7c2567637969257d6b7e69626e656d}
		$mirai_xor_0xb = {00246f6e7d2466627868247c6a7f68636f646c}
		$mirai_xor_0xc = {002368697a2361657f6f237b6d786f6468636b}
		$mirai_xor_0xd = {002269687b2260647e6e227a6c796e6569626a}
		$mirai_xor_0xe = {00216a6b782163677d6d21796f7a6d666a6169}
		$mirai_xor_0xf = {00206b6a792062667c6c20786e7b6c676b6068}
		$mirai_xor_0x10 = {003f7475663f7d7963733f6771647378747f77}
		$mirai_xor_0x11 = {003e7574673e7c7862723e6670657279757e76}
		$mirai_xor_0x12 = {003d7677643d7f7b61713d657366717a767d75}
		$mirai_xor_0x13 = {003c7776653c7e7a60703c647267707b777c74}
		$mirai_xor_0x14 = {003b7071623b797d67773b637560777c707b73}
		$mirai_xor_0x15 = {003a7170633a787c66763a627461767d717a72}
		$mirai_xor_0x16 = {0039727360397b7f657539617762757e727971}
		$mirai_xor_0x17 = {0038737261387a7e647438607663747f737870}
		$mirai_xor_0x18 = {00377c7d6e3775716b7b376f796c7b707c777f}
		$mirai_xor_0x19 = {00367d7c6f3674706a7a366e786d7a717d767e}
		$mirai_xor_0x1a = {00357e7f6c3577736979356d7b6e79727e757d}
		$mirai_xor_0x1b = {00347f7e6d3476726878346c7a6f78737f747c}
		$mirai_xor_0x1c = {003378796a3371756f7f336b7d687f7478737b}
		$mirai_xor_0x1d = {003279786b3270746e7e326a7c697e7579727a}
		$mirai_xor_0x1e = {00317a7b683173776d7d31697f6a7d767a7179}
		$mirai_xor_0x1f = {00307b7a693072766c7c30687e6b7c777b7078}
		$mirai_xor_0x20 = {000f4445560f4d4953430f5741544348444f47}
		$mirai_xor_0x21 = {000e4544570e4c4852420e5640554249454e46}
		$mirai_xor_0x22 = {000d4647540d4f4b51410d554356414a464d45}
		$mirai_xor_0x23 = {000c4746550c4e4a50400c544257404b474c44}
		$mirai_xor_0x24 = {000b4041520b494d57470b534550474c404b43}
		$mirai_xor_0x25 = {000a4140530a484c56460a524451464d414a42}
		$mirai_xor_0x26 = {0009424350094b4f554509514752454e424941}
		$mirai_xor_0x27 = {0008434251084a4e544408504653444f434840}
		$mirai_xor_0x28 = {00074c4d5e0745415b4b075f495c4b404c474f}
		$mirai_xor_0x29 = {00064d4c5f0644405a4a065e485d4a414d464e}
		$mirai_xor_0x2a = {00054e4f5c0547435949055d4b5e49424e454d}
		$mirai_xor_0x2b = {00044f4e5d0446425848045c4a5f48434f444c}
		$mirai_xor_0x2c = {000348495a0341455f4f035b4d584f4448434b}
		$mirai_xor_0x2d = {000249485b0240445e4e025a4c594e4549424a}
		$mirai_xor_0x2e = {00014a4b580143475d4d01594f5a4d464a4149}
		$mirai_xor_0x2f = {00004b4a590042465c4c00584e5b4c474b4048}
		$mirai_xor_0x30 = {001f5455461f5d5943531f4751445358545f57}
		$mirai_xor_0x31 = {001e5554471e5c5842521e4650455259555e56}
		$mirai_xor_0x32 = {001d5657441d5f5b41511d455346515a565d55}
		$mirai_xor_0x33 = {001c5756451c5e5a40501c445247505b575c54}
		$mirai_xor_0x34 = {001b5051421b595d47571b435540575c505b53}
		$mirai_xor_0x35 = {001a5150431a585c46561a425441565d515a52}
		$mirai_xor_0x36 = {0019525340195b5f455519415742555e525951}
		$mirai_xor_0x37 = {0018535241185a5e445418405643545f535850}
		$mirai_xor_0x38 = {00175c5d4e1755514b5b174f594c5b505c575f}
		$mirai_xor_0x39 = {00165d5c4f1654504a5a164e584d5a515d565e}
		$mirai_xor_0x3a = {00155e5f4c1557534959154d5b4e59525e555d}
		$mirai_xor_0x3b = {00145f5e4d1456524858144c5a4f58535f545c}
		$mirai_xor_0x3c = {001358594a1351554f5f134b5d485f5458535b}
		$mirai_xor_0x3d = {001259584b1250544e5e124a5c495e5559525a}
		$mirai_xor_0x3e = {00115a5b481153574d5d11495f4a5d565a5159}
		$mirai_xor_0x3f = {00105b5a491052564c5c10485e4b5c575b5058}
		$mirai_xor_0x40 = {006f2425366f2d2933236f3721342328242f27}
		$mirai_xor_0x41 = {006e2524376e2c2832226e3620352229252e26}
		$mirai_xor_0x42 = {006d2627346d2f2b31216d352336212a262d25}
		$mirai_xor_0x43 = {006c2726356c2e2a30206c342237202b272c24}
		$mirai_xor_0x44 = {006b2021326b292d37276b332530272c202b23}
		$mirai_xor_0x45 = {006a2120336a282c36266a322431262d212a22}
		$mirai_xor_0x46 = {0069222330692b2f352569312732252e222921}
		$mirai_xor_0x47 = {0068232231682a2e342468302633242f232820}
		$mirai_xor_0x48 = {00672c2d3e6725213b2b673f293c2b202c272f}
		$mirai_xor_0x49 = {00662d2c3f6624203a2a663e283d2a212d262e}
		$mirai_xor_0x4a = {00652e2f3c6527233929653d2b3e29222e252d}
		$mirai_xor_0x4b = {00642f2e3d6426223828643c2a3f28232f242c}
		$mirai_xor_0x4c = {006328293a6321253f2f633b2d382f2428232b}
		$mirai_xor_0x4d = {006229283b6220243e2e623a2c392e2529222a}
		$mirai_xor_0x4e = {00612a2b386123273d2d61392f3a2d262a2129}
		$mirai_xor_0x4f = {00602b2a396022263c2c60382e3b2c272b2028}
		$mirai_xor_0x50 = {007f3435267f3d3923337f2731243338343f37}
		$mirai_xor_0x51 = {007e3534277e3c3822327e2630253239353e36}
		$mirai_xor_0x52 = {007d3637247d3f3b21317d253326313a363d35}
		$mirai_xor_0x53 = {007c3736257c3e3a20307c243227303b373c34}
		$mirai_xor_0x54 = {007b3031227b393d27377b233520373c303b33}
		$mirai_xor_0x55 = {007a3130237a383c26367a223421363d313a32}
		$mirai_xor_0x56 = {0079323320793b3f253579213722353e323931}
		$mirai_xor_0x57 = {0078333221783a3e243478203623343f333830}
		$mirai_xor_0x58 = {00773c3d2e7735312b3b772f392c3b303c373f}
		$mirai_xor_0x59 = {00763d3c2f7634302a3a762e382d3a313d363e}
		$mirai_xor_0x5a = {00753e3f2c7537332939752d3b2e39323e353d}
		$mirai_xor_0x5b = {00743f3e2d7436322838742c3a2f38333f343c}
		$mirai_xor_0x5c = {007338392a7331352f3f732b3d283f3438333b}
		$mirai_xor_0x5d = {007239382b7230342e3e722a3c293e3539323a}
		$mirai_xor_0x5e = {00713a3b287133372d3d71293f2a3d363a3139}
		$mirai_xor_0x5f = {00703b3a297032362c3c70283e2b3c373b3038}
		$mirai_xor_0x60 = {004f0405164f0d0913034f1701140308040f07}
		$mirai_xor_0x61 = {004e0504174e0c0812024e1600150209050e06}
		$mirai_xor_0x62 = {004d0607144d0f0b11014d150316010a060d05}
		$mirai_xor_0x63 = {004c0706154c0e0a10004c140217000b070c04}
		$mirai_xor_0x64 = {004b0001124b090d17074b130510070c000b03}
		$mirai_xor_0x65 = {004a0100134a080c16064a120411060d010a02}
		$mirai_xor_0x66 = {0049020310490b0f150549110712050e020901}
		$mirai_xor_0x67 = {0048030211480a0e140448100613040f030800}
		$mirai_xor_0x68 = {00470c0d1e4705011b0b471f091c0b000c070f}
		$mirai_xor_0x69 = {00460d0c1f4604001a0a461e081d0a010d060e}
		$mirai_xor_0x6a = {00450e0f1c4507031909451d0b1e09020e050d}
		$mirai_xor_0x6b = {00440f0e1d4406021808441c0a1f08030f040c}
		$mirai_xor_0x6c = {004308091a4301051f0f431b0d180f0408030b}
		$mirai_xor_0x6d = {004209081b4200041e0e421a0c190e0509020a}
		$mirai_xor_0x6e = {00410a0b184103071d0d41190f1a0d060a0109}
		$mirai_xor_0x6f = {00400b0a194002061c0c40180e1b0c070b0008}
		$mirai_xor_0x70 = {005f1415065f1d1903135f0711041318141f17}
		$mirai_xor_0x71 = {005e1514075e1c1802125e0610051219151e16}
		$mirai_xor_0x72 = {005d1617045d1f1b01115d051306111a161d15}
		$mirai_xor_0x73 = {005c1716055c1e1a00105c041207101b171c14}
		$mirai_xor_0x74 = {005b1011025b191d07175b031500171c101b13}
		$mirai_xor_0x75 = {005a1110035a181c06165a021401161d111a12}
		$mirai_xor_0x76 = {0059121300591b1f051559011702151e121911}
		$mirai_xor_0x77 = {0058131201581a1e041458001603141f131810}
		$mirai_xor_0x78 = {00571c1d0e5715110b1b570f190c1b101c171f}
		$mirai_xor_0x79 = {00561d1c0f5614100a1a560e180d1a111d161e}
		$mirai_xor_0x7a = {00551e1f0c5517130919550d1b0e19121e151d}
		$mirai_xor_0x7b = {00541f1e0d5416120818540c1a0f18131f141c}
		$mirai_xor_0x7c = {005318190a5311150f1f530b1d081f1418131b}
		$mirai_xor_0x7d = {005219180b5210140e1e520a1c091e1519121a}
		$mirai_xor_0x7e = {00511a1b085113170d1d51091f0a1d161a1119}
		$mirai_xor_0x7f = {00501b1a095012160c1c50081e0b1c171b1018}
		$mirai_xor_0x80 = {00afe4e5f6afede9f3e3aff7e1f4e3e8e4efe7}
		$mirai_xor_0x81 = {00aee5e4f7aeece8f2e2aef6e0f5e2e9e5eee6}
		$mirai_xor_0x82 = {00ade6e7f4adefebf1e1adf5e3f6e1eae6ede5}
		$mirai_xor_0x83 = {00ace7e6f5aceeeaf0e0acf4e2f7e0ebe7ece4}
		$mirai_xor_0x84 = {00abe0e1f2abe9edf7e7abf3e5f0e7ece0ebe3}
		$mirai_xor_0x85 = {00aae1e0f3aae8ecf6e6aaf2e4f1e6ede1eae2}
		$mirai_xor_0x86 = {00a9e2e3f0a9ebeff5e5a9f1e7f2e5eee2e9e1}
		$mirai_xor_0x87 = {00a8e3e2f1a8eaeef4e4a8f0e6f3e4efe3e8e0}
		$mirai_xor_0x88 = {00a7ecedfea7e5e1fbeba7ffe9fcebe0ece7ef}
		$mirai_xor_0x89 = {00a6edecffa6e4e0faeaa6fee8fdeae1ede6ee}
		$mirai_xor_0x8a = {00a5eeeffca5e7e3f9e9a5fdebfee9e2eee5ed}
		$mirai_xor_0x8b = {00a4efeefda4e6e2f8e8a4fceaffe8e3efe4ec}
		$mirai_xor_0x8c = {00a3e8e9faa3e1e5ffefa3fbedf8efe4e8e3eb}
		$mirai_xor_0x8d = {00a2e9e8fba2e0e4feeea2faecf9eee5e9e2ea}
		$mirai_xor_0x8e = {00a1eaebf8a1e3e7fdeda1f9effaede6eae1e9}
		$mirai_xor_0x8f = {00a0ebeaf9a0e2e6fceca0f8eefbece7ebe0e8}
		$mirai_xor_0x90 = {00bff4f5e6bffdf9e3f3bfe7f1e4f3f8f4fff7}
		$mirai_xor_0x91 = {00bef5f4e7befcf8e2f2bee6f0e5f2f9f5fef6}
		$mirai_xor_0x92 = {00bdf6f7e4bdfffbe1f1bde5f3e6f1faf6fdf5}
		$mirai_xor_0x93 = {00bcf7f6e5bcfefae0f0bce4f2e7f0fbf7fcf4}
		$mirai_xor_0x94 = {00bbf0f1e2bbf9fde7f7bbe3f5e0f7fcf0fbf3}
		$mirai_xor_0x95 = {00baf1f0e3baf8fce6f6bae2f4e1f6fdf1faf2}
		$mirai_xor_0x96 = {00b9f2f3e0b9fbffe5f5b9e1f7e2f5fef2f9f1}
		$mirai_xor_0x97 = {00b8f3f2e1b8fafee4f4b8e0f6e3f4fff3f8f0}
		$mirai_xor_0x98 = {00b7fcfdeeb7f5f1ebfbb7eff9ecfbf0fcf7ff}
		$mirai_xor_0x99 = {00b6fdfcefb6f4f0eafab6eef8edfaf1fdf6fe}
		$mirai_xor_0x9a = {00b5feffecb5f7f3e9f9b5edfbeef9f2fef5fd}
		$mirai_xor_0x9b = {00b4fffeedb4f6f2e8f8b4ecfaeff8f3fff4fc}
		$mirai_xor_0x9c = {00b3f8f9eab3f1f5efffb3ebfde8fff4f8f3fb}
		$mirai_xor_0x9d = {00b2f9f8ebb2f0f4eefeb2eafce9fef5f9f2fa}
		$mirai_xor_0x9e = {00b1fafbe8b1f3f7edfdb1e9ffeafdf6faf1f9}
		$mirai_xor_0x9f = {00b0fbfae9b0f2f6ecfcb0e8feebfcf7fbf0f8}
		$mirai_xor_0xa0 = {008fc4c5d68fcdc9d3c38fd7c1d4c3c8c4cfc7}
		$mirai_xor_0xa1 = {008ec5c4d78eccc8d2c28ed6c0d5c2c9c5cec6}
		$mirai_xor_0xa2 = {008dc6c7d48dcfcbd1c18dd5c3d6c1cac6cdc5}
		$mirai_xor_0xa3 = {008cc7c6d58ccecad0c08cd4c2d7c0cbc7ccc4}
		$mirai_xor_0xa4 = {008bc0c1d28bc9cdd7c78bd3c5d0c7ccc0cbc3}
		$mirai_xor_0xa5 = {008ac1c0d38ac8ccd6c68ad2c4d1c6cdc1cac2}
		$mirai_xor_0xa6 = {0089c2c3d089cbcfd5c589d1c7d2c5cec2c9c1}
		$mirai_xor_0xa7 = {0088c3c2d188caced4c488d0c6d3c4cfc3c8c0}
		$mirai_xor_0xa8 = {0087cccdde87c5c1dbcb87dfc9dccbc0ccc7cf}
		$mirai_xor_0xa9 = {0086cdccdf86c4c0daca86dec8ddcac1cdc6ce}
		$mirai_xor_0xaa = {0085cecfdc85c7c3d9c985ddcbdec9c2cec5cd}
		$mirai_xor_0xab = {0084cfcedd84c6c2d8c884dccadfc8c3cfc4cc}
		$mirai_xor_0xac = {0083c8c9da83c1c5dfcf83dbcdd8cfc4c8c3cb}
		$mirai_xor_0xad = {0082c9c8db82c0c4dece82daccd9cec5c9c2ca}
		$mirai_xor_0xae = {0081cacbd881c3c7ddcd81d9cfdacdc6cac1c9}
		$mirai_xor_0xaf = {0080cbcad980c2c6dccc80d8cedbccc7cbc0c8}
		$mirai_xor_0xb0 = {009fd4d5c69fddd9c3d39fc7d1c4d3d8d4dfd7}
		$mirai_xor_0xb1 = {009ed5d4c79edcd8c2d29ec6d0c5d2d9d5ded6}
		$mirai_xor_0xb2 = {009dd6d7c49ddfdbc1d19dc5d3c6d1dad6ddd5}
		$mirai_xor_0xb3 = {009cd7d6c59cdedac0d09cc4d2c7d0dbd7dcd4}
		$mirai_xor_0xb4 = {009bd0d1c29bd9ddc7d79bc3d5c0d7dcd0dbd3}
		$mirai_xor_0xb5 = {009ad1d0c39ad8dcc6d69ac2d4c1d6ddd1dad2}
		$mirai_xor_0xb6 = {0099d2d3c099dbdfc5d599c1d7c2d5ded2d9d1}
		$mirai_xor_0xb7 = {0098d3d2c198dadec4d498c0d6c3d4dfd3d8d0}
		$mirai_xor_0xb8 = {0097dcddce97d5d1cbdb97cfd9ccdbd0dcd7df}
		$mirai_xor_0xb9 = {0096dddccf96d4d0cada96ced8cddad1ddd6de}
		$mirai_xor_0xba = {0095dedfcc95d7d3c9d995cddbced9d2ded5dd}
		$mirai_xor_0xbb = {0094dfdecd94d6d2c8d894ccdacfd8d3dfd4dc}
		$mirai_xor_0xbc = {0093d8d9ca93d1d5cfdf93cbddc8dfd4d8d3db}
		$mirai_xor_0xbd = {0092d9d8cb92d0d4cede92cadcc9ded5d9d2da}
		$mirai_xor_0xbe = {0091dadbc891d3d7cddd91c9dfcaddd6dad1d9}
		$mirai_xor_0xbf = {0090dbdac990d2d6ccdc90c8decbdcd7dbd0d8}
		$mirai_xor_0xc0 = {00efa4a5b6efada9b3a3efb7a1b4a3a8a4afa7}
		$mirai_xor_0xc1 = {00eea5a4b7eeaca8b2a2eeb6a0b5a2a9a5aea6}
		$mirai_xor_0xc2 = {00eda6a7b4edafabb1a1edb5a3b6a1aaa6ada5}
		$mirai_xor_0xc3 = {00eca7a6b5ecaeaab0a0ecb4a2b7a0aba7aca4}
		$mirai_xor_0xc4 = {00eba0a1b2eba9adb7a7ebb3a5b0a7aca0aba3}
		$mirai_xor_0xc5 = {00eaa1a0b3eaa8acb6a6eab2a4b1a6ada1aaa2}
		$mirai_xor_0xc6 = {00e9a2a3b0e9abafb5a5e9b1a7b2a5aea2a9a1}
		$mirai_xor_0xc7 = {00e8a3a2b1e8aaaeb4a4e8b0a6b3a4afa3a8a0}
		$mirai_xor_0xc8 = {00e7acadbee7a5a1bbabe7bfa9bcaba0aca7af}
		$mirai_xor_0xc9 = {00e6adacbfe6a4a0baaae6bea8bdaaa1ada6ae}
		$mirai_xor_0xca = {00e5aeafbce5a7a3b9a9e5bdabbea9a2aea5ad}
		$mirai_xor_0xcb = {00e4afaebde4a6a2b8a8e4bcaabfa8a3afa4ac}
		$mirai_xor_0xcc = {00e3a8a9bae3a1a5bfafe3bbadb8afa4a8a3ab}
		$mirai_xor_0xcd = {00e2a9a8bbe2a0a4beaee2baacb9aea5a9a2aa}
		$mirai_xor_0xce = {00e1aaabb8e1a3a7bdade1b9afbaada6aaa1a9}
		$mirai_xor_0xcf = {00e0abaab9e0a2a6bcace0b8aebbaca7aba0a8}
		$mirai_xor_0xd0 = {00ffb4b5a6ffbdb9a3b3ffa7b1a4b3b8b4bfb7}
		$mirai_xor_0xd1 = {00feb5b4a7febcb8a2b2fea6b0a5b2b9b5beb6}
		$mirai_xor_0xd2 = {00fdb6b7a4fdbfbba1b1fda5b3a6b1bab6bdb5}
		$mirai_xor_0xd3 = {00fcb7b6a5fcbebaa0b0fca4b2a7b0bbb7bcb4}
		$mirai_xor_0xd4 = {00fbb0b1a2fbb9bda7b7fba3b5a0b7bcb0bbb3}
		$mirai_xor_0xd5 = {00fab1b0a3fab8bca6b6faa2b4a1b6bdb1bab2}
		$mirai_xor_0xd6 = {00f9b2b3a0f9bbbfa5b5f9a1b7a2b5beb2b9b1}
		$mirai_xor_0xd7 = {00f8b3b2a1f8babea4b4f8a0b6a3b4bfb3b8b0}
		$mirai_xor_0xd8 = {00f7bcbdaef7b5b1abbbf7afb9acbbb0bcb7bf}
		$mirai_xor_0xd9 = {00f6bdbcaff6b4b0aabaf6aeb8adbab1bdb6be}
		$mirai_xor_0xda = {00f5bebfacf5b7b3a9b9f5adbbaeb9b2beb5bd}
		$mirai_xor_0xdb = {00f4bfbeadf4b6b2a8b8f4acbaafb8b3bfb4bc}
		$mirai_xor_0xdc = {00f3b8b9aaf3b1b5afbff3abbda8bfb4b8b3bb}
		$mirai_xor_0xdd = {00f2b9b8abf2b0b4aebef2aabca9beb5b9b2ba}
		$mirai_xor_0xde = {00f1babba8f1b3b7adbdf1a9bfaabdb6bab1b9}
		$mirai_xor_0xdf = {00f0bbbaa9f0b2b6acbcf0a8beabbcb7bbb0b8}
		$mirai_xor_0xe0 = {00cf848596cf8d899383cf9781948388848f87}
		$mirai_xor_0xe1 = {00ce858497ce8c889282ce9680958289858e86}
		$mirai_xor_0xe2 = {00cd868794cd8f8b9181cd958396818a868d85}
		$mirai_xor_0xe3 = {00cc878695cc8e8a9080cc948297808b878c84}
		$mirai_xor_0xe4 = {00cb808192cb898d9787cb938590878c808b83}
		$mirai_xor_0xe5 = {00ca818093ca888c9686ca928491868d818a82}
		$mirai_xor_0xe6 = {00c9828390c98b8f9585c9918792858e828981}
		$mirai_xor_0xe7 = {00c8838291c88a8e9484c8908693848f838880}
		$mirai_xor_0xe8 = {00c78c8d9ec785819b8bc79f899c8b808c878f}
		$mirai_xor_0xe9 = {00c68d8c9fc684809a8ac69e889d8a818d868e}
		$mirai_xor_0xea = {00c58e8f9cc587839989c59d8b9e89828e858d}
		$mirai_xor_0xeb = {00c48f8e9dc486829888c49c8a9f88838f848c}
		$mirai_xor_0xec = {00c388899ac381859f8fc39b8d988f8488838b}
		$mirai_xor_0xed = {00c289889bc280849e8ec29a8c998e8589828a}
		$mirai_xor_0xee = {00c18a8b98c183879d8dc1998f9a8d868a8189}
		$mirai_xor_0xef = {00c08b8a99c082869c8cc0988e9b8c878b8088}
		$mirai_xor_0xf0 = {00df949586df9d998393df8791849398949f97}
		$mirai_xor_0xf1 = {00de959487de9c988292de8690859299959e96}
		$mirai_xor_0xf2 = {00dd969784dd9f9b8191dd859386919a969d95}
		$mirai_xor_0xf3 = {00dc979685dc9e9a8090dc849287909b979c94}
		$mirai_xor_0xf4 = {00db909182db999d8797db839580979c909b93}
		$mirai_xor_0xf5 = {00da919083da989c8696da829481969d919a92}
		$mirai_xor_0xf6 = {00d9929380d99b9f8595d9819782959e929991}
		$mirai_xor_0xf7 = {00d8939281d89a9e8494d8809683949f939890}
		$mirai_xor_0xf8 = {00d79c9d8ed795918b9bd78f998c9b909c979f}
		$mirai_xor_0xf9 = {00d69d9c8fd694908a9ad68e988d9a919d969e}
		$mirai_xor_0xfa = {00d59e9f8cd597938999d58d9b8e99929e959d}
		$mirai_xor_0xfb = {00d49f9e8dd496928898d48c9a8f98939f949c}
		$mirai_xor_0xfc = {00d398998ad391958f9fd38b9d889f9498939b}
		$mirai_xor_0xfd = {00d299988bd290948e9ed28a9c899e9599929a}
		$mirai_xor_0xfe = {00d19a9b88d193978d9dd1899f8a9d969a9199}
		$mirai_xor_0xff = {00d09b9a89d092968c9cd0889e8b9c979b9098}
	condition:
		uint32(0)== 0x464C457F and any of them
} 